<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aioveu.pms.aioveu05Sku.mapper.PmsSkuMapper">

    <!-- 根据商品ID获取商品库存单元列表 -->
    <select id="getSkuListBySpuId" resultType="com.aioveu.pms.aioveu05Sku.model.entity.PmsSku">
        SELECT
            id,
            NAME,
            sku_sn,
            pic_url ,
            spec_ids,
            price ,
            stock
        FROM 
            pms_sku
        WHERE 
            spu_id = #{id}
    </select>

    <!-- 获取商品库存单元信息 -->
    <select id="getSkuInfo" resultType="com.aioveu.pms.model.dto.SkuInfoDTO">
        SELECT
           t1.id ,
           t1.sku_sn,
           concat(t2.name,' ',t1.name) skuName,
           t1.pic_url,
           t1.price,
           t1.stock,
           t2.name as spuName
        FROM
            pms_sku t1
                INNER JOIN pms_spu t2 ON t1.spu_id = t2.id
        WHERE
            t1.id = #{id}
    </select>

    <!-- 获取商品库存分页列表 -->
    <select id="getPmsSkuPage" resultType="com.aioveu.pms.aioveu05Sku.model.vo.PmsSkuVO">
        SELECT
        id,
        sku_sn,
        spu_id,
        name,
        spec_ids,
        price,
        stock,
        locked_stock,
        pic_url,
        create_time,
        update_time
        FROM
        pms_sku
        <where>
            <if test="queryParams.skuSn != null and queryParams.skuSn != ''">
                AND sku_sn LIKE CONCAT(#{queryParams.skuSn}, '%')
            </if>
            <if test="queryParams.spuId != null">
                AND spu_id LIKE CONCAT(#{queryParams.spuId}, '%')
            </if>
            <if test="queryParams.name != null and queryParams.name != ''">
                AND name LIKE CONCAT(#{queryParams.name}, '%')
            </if>
            <if test="queryParams.specIds != null and queryParams.specIds != ''">
                AND spec_ids LIKE CONCAT(#{queryParams.specIds}, '%')
            </if>
        </where>
    </select>

</mapper>
