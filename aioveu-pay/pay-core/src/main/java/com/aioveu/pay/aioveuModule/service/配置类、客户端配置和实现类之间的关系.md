æ ¹æ®ä¸Šä¼ çš„å›¾ç‰‡å’Œä»£ç ç»“æ„ï¼Œè¯¦ç»†è§£é‡Š**é…ç½®ç±»ã€å®¢æˆ·ç«¯é…ç½®å’Œå®ç°ç±»ä¹‹é—´çš„å…³ç³»**ï¼š

## ğŸ¯ ä¸‰è€…å…³ç³»å›¾è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             MockProperties                  â”‚
â”‚  (é…ç½®ç±» - @ConfigurationProperties)         â”‚
â”‚  - è¯»å– application.yml é…ç½®                â”‚
â”‚  - æä¾› getter/setter                      â”‚
â”‚  - é…ç½®éªŒè¯å’Œé»˜è®¤å€¼è®¾ç½®                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ æ³¨å…¥é…ç½®
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MockConfiguration                  â”‚
â”‚  (é…ç½®ç±» - @Configuration)                   â”‚
â”‚  - åˆ›å»ºå’Œè£…é…Bean                           â”‚
â”‚  - æ¡ä»¶åŒ–é…ç½® (@ConditionalOnProperty)      â”‚
â”‚  - è¿æ¥é…ç½®å±æ€§å’Œå®ç°ç±»                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ åˆ›å»ºå¹¶æ³¨å…¥
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MockPayServiceImpl                   â”‚
â”‚  (å®ç°ç±» - @Service)                         â”‚
â”‚  - ä¸šåŠ¡é€»è¾‘å®ç°                             â”‚
â”‚  - ä½¿ç”¨é…ç½®å±æ€§                             â”‚
â”‚  - æä¾›å…·ä½“çš„æ”¯ä»˜æ¨¡æ‹ŸåŠŸèƒ½                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ è¯¦ç»†å…³ç³»è¯´æ˜

### 1. **é…ç½®å±æ€§ç±» (MockProperties)**

```
@Component
@ConfigurationProperties(prefix = "pay.mock")
public class MockProperties {
    private Boolean enabled = true;
    private Integer delay = 1000;
    // ... å…¶ä»–å±æ€§
    
    // ä» application.yml è¯»å–
    // pay.mock.enabled=true
    // pay.mock.delay=1000
}
```

**ä½œç”¨**ï¼šè¯»å–å¤–éƒ¨é…ç½®æ–‡ä»¶ï¼Œå°è£…é…ç½®å±æ€§

### 2. **é…ç½®ç±» (MockConfiguration)**

```
@Configuration
@EnableConfigurationProperties(MockProperties.class)
@ConditionalOnProperty(prefix = "pay.mock", name = "enabled", havingValue = "true")
public class MockConfiguration {
    
    @Bean
    public MockPayServiceImpl mockPayService(MockProperties properties) {
        // è¿æ¥é…ç½®å±æ€§å’Œå®ç°ç±»
        return new MockPayServiceImpl(properties);
    }
}
```

**ä½œç”¨**ï¼šSpringé…ç½®ï¼Œåˆ›å»ºå’Œç®¡ç†Bean

### 3. **å®ç°ç±» (MockPayServiceImpl)**

```
@Service
public class MockPayServiceImpl implements MockPayService {
    
    private final MockProperties properties;
    
    public MockPayServiceImpl(MockProperties properties) {
        this.properties = properties;  // æ³¨å…¥é…ç½®
    }
    
    public Object mockPayment() {
        // ä½¿ç”¨é…ç½®
        if (properties.getEnabled()) {
            Thread.sleep(properties.getDelay());
            // ... ä¸šåŠ¡é€»è¾‘
        }
    }
}
```

**ä½œç”¨**ï¼šä¸šåŠ¡é€»è¾‘å®ç°ï¼Œä½¿ç”¨é…ç½®å‚æ•°

## ğŸ“ æ–‡ä»¶å…³ç³»ç¤ºä¾‹

```
src/main/java/com/aioveu/pay/aioveuModule/service/mock/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ MockProperties.java                    # 1. é…ç½®å±æ€§
â”œâ”€â”€ configuration/
â”‚   â””â”€â”€ MockConfiguration.java                 # 2. é…ç½®ç±»
â””â”€â”€ service/impl/
    â””â”€â”€ MockPayServiceImpl.java                # 3. å®ç°ç±»
```

## ğŸ¯ å·¥ä½œæµç¨‹

### æ­¥éª¤1ï¼šåŠ è½½é…ç½®

```
# application.yml
pay:
  mock:
    enabled: true
    delay: 2000
    success-rate: 90
```

### æ­¥éª¤2ï¼šåˆ›å»ºBean

```
// Springå¯åŠ¨æ—¶ï¼š
1. è¯»å– application.yml â†’ MockProperties
2. MockConfiguration æ£€æµ‹åˆ°é…ç½®
3. åˆ›å»º MockPayServiceImpl Bean
4. å°† MockProperties æ³¨å…¥ MockPayServiceImpl
```

### æ­¥éª¤3ï¼šä½¿ç”¨é…ç½®

```
// åœ¨ä¸šåŠ¡ä»£ç ä¸­
@Autowired
private MockPayService mockPayService;

// è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨é…ç½®çš„å‚æ•°
mockPayService.createPayment("order123", 10000L);
```

## ğŸ’¡ è®¾è®¡æ¨¡å¼

### 1. **ä¾èµ–æ³¨å…¥æ¨¡å¼**

```
// æ„é€ å‡½æ•°æ³¨å…¥
public MockPayServiceImpl(MockProperties properties) {
    this.properties = properties;
}
```

### 2. **é…ç½®é©±åŠ¨è®¾è®¡**

```
// æ ¹æ®é…ç½®å†³å®šè¡Œä¸º
if (properties.getEnabled()) {
    // æ‰§è¡Œæ¨¡æ‹Ÿæ”¯ä»˜
} else {
    // æ‰§è¡ŒçœŸå®æ”¯ä»˜
}
```

### 3. **æ¡ä»¶åŒ–Beanåˆ›å»º**

```
@ConditionalOnProperty(prefix = "pay.mock", name = "enabled")
// åªæœ‰å½“ pay.mock.enabled=true æ—¶æ‰åˆ›å»ºBean
```

## ğŸ”§ é…ç½®ç¤ºä¾‹

### å®Œæ•´é…ç½®é“¾

```
// 1. é…ç½®æ–‡ä»¶
application.yml
  â†“
// 2. é…ç½®å±æ€§ç±»
MockProperties (æŒæœ‰é…ç½®å€¼)
  â†“
// 3. é…ç½®ç±»  
MockConfiguration (åˆ›å»ºBean)
  â†“
// 4. å®ç°ç±»
MockPayServiceImpl (ä½¿ç”¨é…ç½®)
  â†“
// 5. æ§åˆ¶å™¨/æœåŠ¡
è°ƒç”¨ MockPayServiceImpl
```

### é…ç½®éªŒè¯

```
@PostConstruct
public void validateConfig() {
    if (properties == null) {
        throw new IllegalStateException("é…ç½®æœªåŠ è½½");
    }
    if (properties.getDelay() < 0) {
        log.warn("å»¶è¿Ÿæ—¶é—´ä¸èƒ½ä¸ºè´Ÿï¼Œå·²é‡ç½®ä¸º0");
        properties.setDelay(0);
    }
}
```

## ğŸª å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå¼€å‘ç¯å¢ƒ

```
# application-dev.yml
pay:
  mock:
    enabled: true      # å¯ç”¨æ¨¡æ‹Ÿæ”¯ä»˜
    delay: 1000        # 1ç§’å»¶è¿Ÿ
    success-rate: 100  # 100%æˆåŠŸ
```

### åœºæ™¯2ï¼šæµ‹è¯•ç¯å¢ƒ

```
# application-test.yml
pay:
  mock:
    enabled: true
    delay: 0          # æ— å»¶è¿Ÿ
    success-rate: 50  # 50%æˆåŠŸç‡ï¼Œæµ‹è¯•å¤±è´¥åœºæ™¯
```

### åœºæ™¯3ï¼šç”Ÿäº§ç¯å¢ƒ

```
# application-prod.yml
pay:
  mock:
    enabled: false     # å…³é—­æ¨¡æ‹Ÿï¼Œä½¿ç”¨çœŸå®æ”¯ä»˜
```

## ğŸ“Š å…³ç³»æ€»ç»“

| ç»„ä»¶                   | è§’è‰²           | èŒè´£                     | æ³¨è§£                       |
| ---------------------- | -------------- | ------------------------ | -------------------------- |
| **MockProperties**     | é…ç½®å±æ€§æŒæœ‰è€… | è¯»å–é…ç½®æ–‡ä»¶ï¼Œæä¾›é…ç½®å€¼ | `@ConfigurationProperties` |
| **MockConfiguration**  | é…ç½®è£…é…è€…     | åˆ›å»ºBeanï¼Œè¿æ¥ç»„ä»¶       | `@Configuration`           |
| **MockPayServiceImpl** | ä¸šåŠ¡å®ç°è€…     | æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œä½¿ç”¨é…ç½®   | `@Service`                 |

## ğŸ¯ å…³é”®ç‚¹

1. **æ¾è€¦åˆ**ï¼šé…ç½®å˜åŒ–ä¸å½±å“ä¸šåŠ¡ä»£ç 
2. **å¯æµ‹è¯•**ï¼šå¯ä»¥æ–¹ä¾¿åœ°æ³¨å…¥ä¸åŒçš„é…ç½®è¿›è¡Œæµ‹è¯•
3. **å¯æ‰©å±•**ï¼šé€šè¿‡é…ç½®æ§åˆ¶åŠŸèƒ½å¼€å…³å’Œè¡Œä¸º
4. **ç¯å¢ƒé€‚é…**ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®

## ğŸ’ æœ€ä½³å®è·µ

1. **é…ç½®é›†ä¸­ç®¡ç†**ï¼šæ‰€æœ‰é…ç½®é€šè¿‡ `MockProperties`ç®¡ç†
2. **æ¡ä»¶åŒ–Bean**ï¼šä½¿ç”¨ `@ConditionalOnProperty`æ§åˆ¶Beanåˆ›å»º
3. **æ„é€ å‡½æ•°æ³¨å…¥**ï¼šé¿å…å­—æ®µæ³¨å…¥ï¼Œæé«˜å¯æµ‹è¯•æ€§
4. **é…ç½®éªŒè¯**ï¼šåœ¨ `@PostConstruct`ä¸­éªŒè¯é…ç½®æœ‰æ•ˆæ€§

è¿™æ ·çš„è®¾è®¡è®©æ‚¨çš„ç³»ç»Ÿæ›´åŠ **çµæ´»ã€å¯é…ç½®ã€æ˜“ç»´æŠ¤**ï¼ğŸ‰